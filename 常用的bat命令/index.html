<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常用的bat命令 | 阳九五的博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="用于记录相关信息">
    <meta property="article:modified_time" content="2025-11-17T02:23:58.000Z">
    <meta property="og:site_name" content="阳九五的博客">
    <meta property="og:title" content="常用的bat命令">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://blog.56321654.xyz/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/">
    <meta name="twitter:title" content="常用的bat命令">
    <meta name="twitter:url" content="https://blog.56321654.xyz/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="程序员, 编程, 计算机">
    <meta property="article:tag" content="程序员">
    <meta name="keywords" content="阳九五的博客,用于记录相关信息">
    
    <link rel="preload" href="/assets/css/0.styles.dda7987c.css" as="style"><link rel="preload" href="/assets/js/app.a3927c81.js" as="script"><link rel="preload" href="/assets/js/2.774f00ec.js" as="script"><link rel="preload" href="/assets/js/95.de2f22d5.js" as="script"><link rel="prefetch" href="/assets/js/1.a3473cb3.js"><link rel="prefetch" href="/assets/js/10.31fe43c3.js"><link rel="prefetch" href="/assets/js/100.d1f00c29.js"><link rel="prefetch" href="/assets/js/101.171ca2fd.js"><link rel="prefetch" href="/assets/js/102.8bcc2372.js"><link rel="prefetch" href="/assets/js/103.92bcd0d1.js"><link rel="prefetch" href="/assets/js/104.96b3230e.js"><link rel="prefetch" href="/assets/js/105.93d05375.js"><link rel="prefetch" href="/assets/js/106.567c3107.js"><link rel="prefetch" href="/assets/js/107.821feb2c.js"><link rel="prefetch" href="/assets/js/108.90979b64.js"><link rel="prefetch" href="/assets/js/109.17bccca4.js"><link rel="prefetch" href="/assets/js/11.da61ab4f.js"><link rel="prefetch" href="/assets/js/110.7e943a87.js"><link rel="prefetch" href="/assets/js/12.3444433d.js"><link rel="prefetch" href="/assets/js/13.216e158c.js"><link rel="prefetch" href="/assets/js/14.07bf0faa.js"><link rel="prefetch" href="/assets/js/15.53d4c7a6.js"><link rel="prefetch" href="/assets/js/16.a10aea4e.js"><link rel="prefetch" href="/assets/js/17.a3a20672.js"><link rel="prefetch" href="/assets/js/18.42f97eea.js"><link rel="prefetch" href="/assets/js/19.b1e00da9.js"><link rel="prefetch" href="/assets/js/20.d0b8fdbb.js"><link rel="prefetch" href="/assets/js/21.38b8814f.js"><link rel="prefetch" href="/assets/js/22.bb14da9f.js"><link rel="prefetch" href="/assets/js/23.ceb5a5ff.js"><link rel="prefetch" href="/assets/js/24.69dbbda4.js"><link rel="prefetch" href="/assets/js/25.15e1f641.js"><link rel="prefetch" href="/assets/js/26.05593ccd.js"><link rel="prefetch" href="/assets/js/27.f86cd602.js"><link rel="prefetch" href="/assets/js/28.dce861e8.js"><link rel="prefetch" href="/assets/js/29.e463b50f.js"><link rel="prefetch" href="/assets/js/3.dc953eef.js"><link rel="prefetch" href="/assets/js/30.6cc1783f.js"><link rel="prefetch" href="/assets/js/31.66df05eb.js"><link rel="prefetch" href="/assets/js/32.145c5a13.js"><link rel="prefetch" href="/assets/js/33.531a6d80.js"><link rel="prefetch" href="/assets/js/34.9d5fb3be.js"><link rel="prefetch" href="/assets/js/35.46c99029.js"><link rel="prefetch" href="/assets/js/36.83e77b7d.js"><link rel="prefetch" href="/assets/js/37.507fa20f.js"><link rel="prefetch" href="/assets/js/38.bddaa2f4.js"><link rel="prefetch" href="/assets/js/39.fe1d8344.js"><link rel="prefetch" href="/assets/js/4.2f502b73.js"><link rel="prefetch" href="/assets/js/40.4b88ed87.js"><link rel="prefetch" href="/assets/js/41.3606063e.js"><link rel="prefetch" href="/assets/js/42.5fb63480.js"><link rel="prefetch" href="/assets/js/43.2c23e479.js"><link rel="prefetch" href="/assets/js/44.71753598.js"><link rel="prefetch" href="/assets/js/45.8ca5f219.js"><link rel="prefetch" href="/assets/js/46.eaad1a71.js"><link rel="prefetch" href="/assets/js/47.069e1339.js"><link rel="prefetch" href="/assets/js/48.b7934276.js"><link rel="prefetch" href="/assets/js/49.b37ddadf.js"><link rel="prefetch" href="/assets/js/5.7b1f056c.js"><link rel="prefetch" href="/assets/js/50.03e01968.js"><link rel="prefetch" href="/assets/js/51.6428953c.js"><link rel="prefetch" href="/assets/js/52.e1307106.js"><link rel="prefetch" href="/assets/js/53.56c00ed7.js"><link rel="prefetch" href="/assets/js/54.30169cb4.js"><link rel="prefetch" href="/assets/js/55.566f3c84.js"><link rel="prefetch" href="/assets/js/56.16ff0ab8.js"><link rel="prefetch" href="/assets/js/57.9b99c9a4.js"><link rel="prefetch" href="/assets/js/58.67069e03.js"><link rel="prefetch" href="/assets/js/59.3943f21d.js"><link rel="prefetch" href="/assets/js/6.056886f1.js"><link rel="prefetch" href="/assets/js/60.603aa272.js"><link rel="prefetch" href="/assets/js/61.4319a064.js"><link rel="prefetch" href="/assets/js/62.c456f40f.js"><link rel="prefetch" href="/assets/js/63.273e36a9.js"><link rel="prefetch" href="/assets/js/64.e81d8f03.js"><link rel="prefetch" href="/assets/js/65.cc96ea5c.js"><link rel="prefetch" href="/assets/js/66.e76cc1b1.js"><link rel="prefetch" href="/assets/js/67.0513723b.js"><link rel="prefetch" href="/assets/js/68.edc0357c.js"><link rel="prefetch" href="/assets/js/69.e7f1e317.js"><link rel="prefetch" href="/assets/js/7.a96cecf9.js"><link rel="prefetch" href="/assets/js/70.b6a22008.js"><link rel="prefetch" href="/assets/js/71.9c2e53e8.js"><link rel="prefetch" href="/assets/js/72.71072385.js"><link rel="prefetch" href="/assets/js/73.90aad6c1.js"><link rel="prefetch" href="/assets/js/74.315d5f33.js"><link rel="prefetch" href="/assets/js/75.cdaf9e00.js"><link rel="prefetch" href="/assets/js/76.263b2e0f.js"><link rel="prefetch" href="/assets/js/77.c3a10ff3.js"><link rel="prefetch" href="/assets/js/78.97fb2243.js"><link rel="prefetch" href="/assets/js/79.0762bccd.js"><link rel="prefetch" href="/assets/js/80.9b3e42cd.js"><link rel="prefetch" href="/assets/js/81.d303c8e5.js"><link rel="prefetch" href="/assets/js/82.f4269c0b.js"><link rel="prefetch" href="/assets/js/83.2e7830b2.js"><link rel="prefetch" href="/assets/js/84.24a2be25.js"><link rel="prefetch" href="/assets/js/85.72b45364.js"><link rel="prefetch" href="/assets/js/86.f700b4c0.js"><link rel="prefetch" href="/assets/js/87.d68183d2.js"><link rel="prefetch" href="/assets/js/88.fe6a937b.js"><link rel="prefetch" href="/assets/js/89.e35dec0f.js"><link rel="prefetch" href="/assets/js/90.9ae2b3b3.js"><link rel="prefetch" href="/assets/js/91.a629c465.js"><link rel="prefetch" href="/assets/js/92.9a323ca0.js"><link rel="prefetch" href="/assets/js/93.1ff60f72.js"><link rel="prefetch" href="/assets/js/94.022d76a7.js"><link rel="prefetch" href="/assets/js/96.05df4604.js"><link rel="prefetch" href="/assets/js/97.f748f41c.js"><link rel="prefetch" href="/assets/js/98.ce0d6a8e.js"><link rel="prefetch" href="/assets/js/99.53c8805c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.9f962556.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dda7987c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="阳九五的博客" class="logo"> <span class="site-name can-hide">阳九五的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/docs/dart/" class="nav-link">
  Dart
</a></div><div class="nav-item"><a href="/docs/flutter/" class="nav-link">
  Flutter
</a></div><div class="nav-item"><a href="/docs/other/" class="nav-link">
  Other
</a></div> <a href="https://github.com/CN-YoungYang/CN-YoungYang.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/docs/dart/" class="nav-link">
  Dart
</a></div><div class="nav-item"><a href="/docs/flutter/" class="nav-link">
  Flutter
</a></div><div class="nav-item"><a href="/docs/other/" class="nav-link">
  Other
</a></div> <a href="https://github.com/CN-YoungYang/CN-YoungYang.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/other/" class="sidebar-link">Other</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>系统工具</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/c%E7%9B%98%E6%B8%85%E7%90%86%E6%80%9D%E8%B7%AF/" class="sidebar-link">C盘清理思路</a></li><li><a href="/mklink%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/" class="sidebar-link">mklink 命令详解</a></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/" aria-current="page" class="active sidebar-link">常用的bat命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#windows命令兼容性说明" class="sidebar-link">Windows命令兼容性说明</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#如何创建bat文件" class="sidebar-link">如何创建bat文件</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#系统管理" class="sidebar-link">系统管理</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#文件和文件夹操作" class="sidebar-link">文件和文件夹操作</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#进程管理" class="sidebar-link">进程管理</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#环境变量" class="sidebar-link">环境变量</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#磁盘管理" class="sidebar-link">磁盘管理</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#网络管理" class="sidebar-link">网络管理</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#远程服务器管理" class="sidebar-link">远程服务器管理</a></li><li class="sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#实用脚本示例" class="sidebar-link">实用脚本示例</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>自动化脚本</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content"><div style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="常用的bat命令"><a href="#常用的bat命令" class="header-anchor">#</a> 常用的bat命令</h1> <h2 id="windows命令兼容性说明"><a href="#windows命令兼容性说明" class="header-anchor">#</a> Windows命令兼容性说明</h2> <p>本文档中的bat命令主要针对Windows系统设计，不同Windows版本的兼容性如下：</p> <h3 id="完全兼容的windows版本"><a href="#完全兼容的windows版本" class="header-anchor">#</a> 完全兼容的Windows版本</h3> <ul><li><strong>Windows 10/11</strong>: 所有命令均完全支持</li> <li><strong>Windows Server 2016/2019/2022</strong>: 所有命令均完全支持</li> <li><strong>Windows 8/8.1</strong>: 绝大多数命令支持，部分新功能可能不可用</li> <li><strong>Windows 7</strong>: 大部分命令支持，部分高级功能可能受限</li></ul> <h3 id="需要注意的命令"><a href="#需要注意的命令" class="header-anchor">#</a> 需要注意的命令</h3> <ul><li><strong>PowerShell相关命令</strong>: Windows 7及更早版本需要单独安装PowerShell</li> <li><strong>SSH命令</strong>: Windows 10 1809及以后版本内置，早期版本需要单独安装OpenSSH</li> <li><strong>WinRM命令</strong>: Windows 7及以后版本支持，但需要手动配置</li> <li><strong>部分高级网络命令</strong>: 较旧的Windows版本可能不支持所有参数</li></ul> <h3 id="权限要求"><a href="#权限要求" class="header-anchor">#</a> 权限要求</h3> <ul><li><strong>基本命令</strong>: 普通用户权限即可执行</li> <li><strong>系统管理命令</strong>: 需要管理员权限（如shutdown、chkdsk等）</li> <li><strong>网络相关命令</strong>: 某些网络配置需要管理员权限</li> <li><strong>远程连接命令</strong>: 需要相应的网络和系统权限</li></ul> <h3 id="使用建议"><a href="#使用建议" class="header-anchor">#</a> 使用建议</h3> <ol><li>在使用命令前，建议先在测试环境中验证</li> <li>对于需要管理员权限的命令，请右键&quot;以管理员身份运行&quot;</li> <li>在较旧的Windows系统上使用时，请检查命令的可用性</li> <li>某些命令可能需要先启用相关Windows功能（如Telnet客户端）</li></ol> <hr> <h2 id="如何创建bat文件"><a href="#如何创建bat文件" class="header-anchor">#</a> 如何创建bat文件</h2> <h3 id="方法一-使用记事本创建"><a href="#方法一-使用记事本创建" class="header-anchor">#</a> 方法一：使用记事本创建</h3> <ol><li>打开记事本（Notepad）</li> <li>输入所需的bat命令</li> <li>点击&quot;文件&quot; → &quot;另存为&quot;</li> <li>在&quot;保存类型&quot;中选择&quot;所有文件&quot;</li> <li>在文件名中输入以<code>.bat</code>结尾的文件名（如<code>myscript.bat</code>）</li> <li>选择保存位置，点击&quot;保存&quot;</li></ol> <h3 id="方法二-使用文本编辑器创建"><a href="#方法二-使用文本编辑器创建" class="header-anchor">#</a> 方法二：使用文本编辑器创建</h3> <ol><li>打开任何文本编辑器（如VS Code、Sublime Text等）</li> <li>输入bat命令</li> <li>保存文件时，将文件扩展名设置为<code>.bat</code></li></ol> <h3 id="方法三-直接在文件夹中创建"><a href="#方法三-直接在文件夹中创建" class="header-anchor">#</a> 方法三：直接在文件夹中创建</h3> <ol><li>打开要创建bat文件的文件夹</li> <li>右键点击空白处 → &quot;新建&quot; → &quot;文本文档&quot;</li> <li>将新建的文本文档重命名为以<code>.bat</code>结尾的文件名</li> <li>确认更改文件扩展名</li> <li>右键点击新建的bat文件 → &quot;编辑&quot;</li> <li>在打开的记事本中输入命令并保存</li></ol> <h3 id="bat文件基本语法"><a href="#bat文件基本语法" class="header-anchor">#</a> bat文件基本语法</h3> <ul><li>每行一个命令</li> <li>使用<code>@echo off</code>关闭命令回显</li> <li>使用<code>echo</code>显示文本信息</li> <li>使用<code>pause</code>暂停执行，等待用户按键</li> <li>使用<code>rem</code>或<code>::</code>添加注释</li></ul> <h3 id="简单示例"><a href="#简单示例" class="header-anchor">#</a> 简单示例</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
echo 这是一个简单的bat脚本示例
echo 当前时间是：%date% %time%
pause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="运行bat文件"><a href="#运行bat文件" class="header-anchor">#</a> 运行bat文件</h3> <ul><li>双击bat文件直接运行</li> <li>右键点击bat文件 → &quot;以管理员身份运行&quot;（需要管理员权限的命令）</li> <li>在命令提示符中输入bat文件路径运行</li></ul> <hr> <h2 id="系统管理"><a href="#系统管理" class="header-anchor">#</a> 系统管理</h2> <h3 id="重启资源管理器"><a href="#重启资源管理器" class="header-anchor">#</a> 重启资源管理器</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>taskkill /f /im explorer.exe
start explorer.exe
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>taskkill</code>: 结束进程命令
<ul><li><code>/f</code>: 强制终止进程</li> <li><code>/im</code>: 指定进程映像名称</li></ul></li> <li><code>start</code>: 启动程序命令</li></ul> <p><strong>使用场景：</strong>
当桌面图标消失、任务栏无响应或资源管理器出现异常时，可以使用此命令重启资源管理器，通常能解决大部分界面显示问题。</p> <hr> <h3 id="关闭计算机"><a href="#关闭计算机" class="header-anchor">#</a> 关闭计算机</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>shutdown /s /t 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>/s</code>: 关闭计算机</li> <li><code>/t 0</code>: 设置关机倒计时为0秒（立即执行）</li></ul> <p><strong>其他常用参数：</strong></p> <ul><li><code>/f</code>: 强制关闭正在运行的应用程序而不警告</li> <li><code>/c &quot;注释&quot;</code>: 关机前的注释（最多512个字符）</li></ul> <p><strong>使用场景：</strong></p> <ul><li>系统维护完成后需要关机</li> <li>远程管理时需要关闭远程计算机</li> <li>自动化脚本中的关机操作</li></ul> <hr> <h3 id="重启计算机"><a href="#重启计算机" class="header-anchor">#</a> 重启计算机</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>shutdown /r /t 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>/r</code>: 重启计算机</li> <li><code>/t 0</code>: 设置重启倒计时为0秒（立即执行）</li></ul> <p><strong>使用场景：</strong></p> <ul><li>安装系统更新后需要重启</li> <li>系统出现异常需要重启恢复</li> <li>远程管理时需要重启远程计算机</li></ul> <hr> <h3 id="注销当前用户"><a href="#注销当前用户" class="header-anchor">#</a> 注销当前用户</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>shutdown /l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>/l</code>: 注销当前用户</li></ul> <p><strong>使用场景：</strong></p> <ul><li>需要切换用户账户</li> <li>用户配置文件出现问题需要重新加载</li> <li>公共计算机上用户使用完毕后注销</li></ul> <hr> <h3 id="锁定计算机"><a href="#锁定计算机" class="header-anchor">#</a> 锁定计算机</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>rundll32.exe user32.dll,LockWorkStation
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>rundll32.exe</code>: 运行DLL中的导出函数</li> <li><code>user32.dll</code>: Windows用户界面API库</li> <li><code>LockWorkStation</code>: 锁定工作站的函数</li></ul> <p><strong>使用场景：</strong></p> <ul><li>暂时离开电脑时保护隐私和数据安全</li> <li>企业环境中强制员工离开时锁定计算机</li> <li>自动化安全策略的一部分</li></ul> <hr> <h3 id="查看系统信息"><a href="#查看系统信息" class="header-anchor">#</a> 查看系统信息</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>systeminfo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li>无需参数，直接执行即可显示完整系统信息</li></ul> <p><strong>可选参数：</strong></p> <ul><li><code>/fo table</code>: 以表格格式显示</li> <li><code>/fo list</code>: 以列表格式显示</li> <li><code>/fo csv</code>: 以CSV格式显示</li> <li><code>&gt; 文件名.txt</code>: 将输出重定向到文件</li></ul> <p><strong>使用场景：</strong></p> <ul><li>系统故障排查时查看硬件和软件配置</li> <li>获取系统详细信息用于技术支持</li> <li>审计和记录系统配置</li></ul> <hr> <h3 id="查看ip配置"><a href="#查看ip配置" class="header-anchor">#</a> 查看IP配置</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>ipconfig
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li>无参数时显示基本IP配置信息</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/all</code>: 显示详细配置信息（包括MAC地址、DNS服务器等）</li> <li><code>/release</code>: 释放指定适配器的IP地址</li> <li><code>/renew</code>: 重新获取指定适配器的IP地址</li> <li><code>/flushdns</code>: 清除DNS解析缓存</li></ul> <p><strong>使用场景：</strong></p> <ul><li>网络连接故障排查</li> <li>查看计算机IP地址和网关信息</li> <li>网络配置验证</li></ul> <hr> <h3 id="刷新dns缓存"><a href="#刷新dns缓存" class="header-anchor">#</a> 刷新DNS缓存</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>ipconfig /flushdns
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>/flushdns</code>: 清除并重置DNS解析器缓存</li></ul> <p><strong>使用场景：</strong></p> <ul><li>网站无法访问但网络连接正常</li> <li>DNS服务器更改后需要更新本地缓存</li> <li>解决DNS解析相关的问题</li></ul> <hr> <h3 id="ping测试网络连接"><a href="#ping测试网络连接" class="header-anchor">#</a> ping测试网络连接</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>ping www.baidu.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>ping</code>: 网络诊断工具，测试与目标主机的连接</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>-t</code>: 持续ping直到手动停止（Ctrl+C）</li> <li><code>-n 数量</code>: 指定发送的回显请求数量</li> <li><code>-l 大小</code>: 指定发送的缓冲区大小</li> <li><code>-w 超时</code>: 指定等待每个回复的超时时间（毫秒）</li></ul> <p><strong>使用场景：</strong></p> <ul><li>测试网络连通性</li> <li>测量网络延迟</li> <li>诊断网络故障</li> <li>验证DNS解析是否正常</li></ul> <hr> <h2 id="文件和文件夹操作"><a href="#文件和文件夹操作" class="header-anchor">#</a> 文件和文件夹操作</h2> <h3 id="创建文件夹"><a href="#创建文件夹" class="header-anchor">#</a> 创建文件夹</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>mkdir 新文件夹名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>mkdir</code> (或 <code>md</code>): 创建目录命令</li></ul> <p><strong>使用场景：</strong></p> <ul><li>组织文件时创建新的分类文件夹</li> <li>安装软件前创建必要的目录结构</li> <li>批量处理文件时创建目标文件夹</li></ul> <hr> <h3 id="删除文件夹"><a href="#删除文件夹" class="header-anchor">#</a> 删除文件夹</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>rmdir 文件夹名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>rmdir</code> (或 <code>rd</code>): 删除目录命令</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/s</code>: 删除目录树（即目录及其所有子目录和文件）</li> <li><code>/q</code>: 安静模式，删除目录树时不要求确认</li></ul> <p><strong>使用场景：</strong></p> <ul><li>清理不再需要的文件夹</li> <li>卸载软件后删除残留目录</li> <li>定期清理临时文件夹</li></ul> <hr> <h3 id="复制文件"><a href="#复制文件" class="header-anchor">#</a> 复制文件</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>copy 源文件 目标文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>copy</code>: 复制一个或多个文件</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/y</code>: 禁止提示确认要覆盖现有目标文件</li> <li><code>/-y</code>: 提示确认要覆盖现有目标文件</li> <li><code>/v</code>: 验证新文件写入是否正确</li></ul> <p><strong>使用场景：</strong></p> <ul><li>备份重要文件</li> <li>在不同位置创建文件副本</li> <li>分发文件给多个用户</li></ul> <hr> <h3 id="复制文件夹及其内容"><a href="#复制文件夹及其内容" class="header-anchor">#</a> 复制文件夹及其内容</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>xcopy 源文件夹 目标文件夹 /e /i
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>xcopy</code>: 高级文件复制命令</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/e</code>: 复制目录和子目录，包括空的</li> <li><code>/i</code>: 如果目标不存在且复制多个文件，则假定目标必须是目录</li> <li><code>/h</code>: 复制隐藏文件和系统文件</li> <li><code>/k</code>: 复制属性，正常的xcopy会重置只读属性</li> <li><code>/y</code>: 禁止提示确认要覆盖现有目标文件</li></ul> <p><strong>使用场景：</strong></p> <ul><li>完整备份文件夹结构</li> <li>迁移用户数据到新位置</li> <li>部署应用程序文件</li></ul> <hr> <h3 id="删除文件"><a href="#删除文件" class="header-anchor">#</a> 删除文件</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>del 文件名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>del</code> (或 <code>erase</code>): 删除一个或多个文件</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/p</code>: 删除每个文件之前提示确认</li> <li><code>/f</code>: 强制删除只读文件</li> <li><code>/s</code>: 从当前目录及所有子目录删除指定文件</li> <li><code>/q</code>: 安静模式，删除全局通配符时不要求确认</li></ul> <p><strong>使用场景：</strong></p> <ul><li>清理临时文件</li> <li>删除过期的备份文件</li> <li>清理下载文件夹</li></ul> <hr> <h2 id="进程管理"><a href="#进程管理" class="header-anchor">#</a> 进程管理</h2> <h3 id="查看运行中的进程"><a href="#查看运行中的进程" class="header-anchor">#</a> 查看运行中的进程</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>tasklist
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>tasklist</code>: 显示当前运行在本地或远程计算机上的进程</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/m 模块名</code>: 列出加载指定DLL模块的所有进程</li> <li><code>/svc</code>: 显示每个进程中的服务</li> <li><code>/v</code>: 显示详细任务信息</li> <li><code>/fo table</code>: 以表格格式显示（默认）</li> <li><code>/fo csv</code>: 以CSV格式显示</li></ul> <p><strong>使用场景：</strong></p> <ul><li>查看系统资源占用情况</li> <li>识别可疑或恶意进程</li> <li>监控特定应用程序是否在运行</li></ul> <hr> <h3 id="结束指定进程"><a href="#结束指定进程" class="header-anchor">#</a> 结束指定进程</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>taskkill /f /im 进程名.exe
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>taskkill</code>: 结束一个或多个任务或进程</li> <li><code>/f</code>: 强制终止进程</li> <li><code>/im</code>: 指定要终止的进程的映像名称</li></ul> <p><strong>其他常用参数：</strong></p> <ul><li><code>/pid 进程ID</code>: 指定要终止的进程的PID</li> <li><code>/t</code>: 终止指定的进程和由它启动的子进程</li> <li><code>/fi 筛选器</code>: 指定筛选器条件</li></ul> <p><strong>使用场景：</strong></p> <ul><li>结束无响应的应用程序</li> <li>终止恶意软件进程</li> <li>释放被占用的系统资源</li></ul> <hr> <h2 id="环境变量"><a href="#环境变量" class="header-anchor">#</a> 环境变量</h2> <h3 id="查看所有环境变量"><a href="#查看所有环境变量" class="header-anchor">#</a> 查看所有环境变量</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>set
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>set</code>: 显示、设置或删除环境变量</li></ul> <p><strong>使用场景：</strong></p> <ul><li>查看当前系统环境配置</li> <li>故障排查时检查路径设置</li> <li>了解系统配置信息</li></ul> <hr> <h3 id="设置临时环境变量"><a href="#设置临时环境变量" class="header-anchor">#</a> 设置临时环境变量</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>set 变量名=变量值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>变量名</code>: 要设置的环境变量名称</li> <li><code>变量值</code>: 要赋给变量的值</li></ul> <p><strong>使用场景：</strong></p> <ul><li>临时修改程序运行环境</li> <li>批处理脚本中传递参数</li> <li>测试不同环境配置</li></ul> <hr> <h2 id="磁盘管理"><a href="#磁盘管理" class="header-anchor">#</a> 磁盘管理</h2> <h3 id="查看磁盘使用情况"><a href="#查看磁盘使用情况" class="header-anchor">#</a> 查看磁盘使用情况</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>wmic logicaldisk get size,freespace,caption
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>wmic</code>: Windows管理接口命令行</li> <li><code>logicaldisk</code>: 查询逻辑磁盘信息</li> <li><code>get</code>: 获取指定属性</li> <li><code>size</code>: 磁盘总大小</li> <li><code>freespace</code>: 可用空间</li> <li><code>caption</code>: 磁盘盘符</li></ul> <p><strong>使用场景：</strong></p> <ul><li>监控磁盘空间使用情况</li> <li>规划磁盘空间分配</li> <li>磁盘空间不足预警</li></ul> <hr> <h3 id="磁盘检查"><a href="#磁盘检查" class="header-anchor">#</a> 磁盘检查</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>chkdsk C: /f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>chkdsk</code>: 检查磁盘并显示状态报告</li> <li><code>C:</code>: 要检查的驱动器</li> <li><code>/f</code>: 修复磁盘上的错误</li></ul> <p><strong>其他常用参数：</strong></p> <ul><li><code>/r</code>: 查找坏扇区并恢复可读取的信息</li> <li><code>/v</code>: 在FAT/FAT32上显示磁盘上每个文件的完整路径和名称</li> <li><code>/x</code>: 如果需要，强制卷先卸除</li></ul> <p><strong>使用场景：</strong></p> <ul><li>系统出现文件损坏错误</li> <li>磁盘性能下降时检查</li> <li>定期维护磁盘健康状态</li></ul> <hr> <h2 id="网络管理"><a href="#网络管理" class="header-anchor">#</a> 网络管理</h2> <h3 id="查看网络连接"><a href="#查看网络连接" class="header-anchor">#</a> 查看网络连接</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>netstat -an
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>netstat</code>: 显示网络连接、路由表和网络接口统计信息</li> <li><code>-a</code>: 显示所有连接和监听端口</li> <li><code>-n</code>: 以数字形式显示地址和端口号</li></ul> <p><strong>其他常用参数：</strong></p> <ul><li><code>-o</code>: 显示每个连接的进程ID</li> <li><code>-b</code>: 显示创建每个连接或监听端口的可执行程序</li> <li><code>-r</code>: 显示路由表</li></ul> <p><strong>使用场景：</strong></p> <ul><li>检查是否有异常网络连接</li> <li>查看哪些端口正在监听</li> <li>网络故障诊断</li></ul> <hr> <h3 id="映射网络驱动器"><a href="#映射网络驱动器" class="header-anchor">#</a> 映射网络驱动器</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>net use Z: \\服务器名\共享文件夹
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>net use</code>: 连接或断开计算机与共享资源的连接</li> <li><code>Z:</code>: 要映射的本地驱动器盘符</li> <li><code>\\服务器名\共享文件夹</code>: 网络共享路径</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/user:用户名</code>: 指定连接时使用的用户名</li> <li><code>/persistent:yes</code>: 使连接在重启后仍然保持</li> <li><code>/delete</code>: 删除指定的网络连接</li></ul> <p><strong>使用场景：</strong></p> <ul><li>访问网络共享资源</li> <li>企业环境中映射共享文件夹</li> <li>备份数据到网络位置</li></ul> <hr> <h3 id="远程桌面连接"><a href="#远程桌面连接" class="header-anchor">#</a> 远程桌面连接</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>mstsc /v:远程服务器IP或主机名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>mstsc</code>: 远程桌面连接程序</li> <li><code>/v:服务器地址</code>: 指定要连接的远程计算机</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>/f</code>: 全屏模式启动</li> <li><code>/admin</code>: 连接到管理会话</li> <li><code>/multimon</code>: 使用多个显示器</li> <li><code>/w:宽度</code> <code>/h:高度</code>: 指定远程桌面窗口大小</li> <li><code>/public</code>: 在公共模式下运行</li></ul> <p><strong>使用场景：</strong></p> <ul><li>远程管理服务器</li> <li>技术支持远程协助</li> <li>家庭办公连接公司电脑</li></ul> <hr> <h3 id="使用凭据连接远程服务器"><a href="#使用凭据连接远程服务器" class="header-anchor">#</a> 使用凭据连接远程服务器</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>cmdkey /generic:TERMSRV/远程服务器IP /user:用户名 /pass:密码
mstsc /v:远程服务器IP
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>cmdkey</code>: 创建、显示和删除保存的用户名和密码</li> <li><code>/generic:TERMSRV/服务器IP</code>: 为远程桌面连接创建凭据</li> <li><code>/user:用户名</code>: 指定用户名</li> <li><code>/pass:密码</code>: 指定密码</li></ul> <p><strong>使用场景：</strong></p> <ul><li>自动化远程桌面连接</li> <li>批量管理多台服务器</li> <li>脚本化远程维护任务</li></ul> <hr> <h3 id="ssh连接远程服务器"><a href="#ssh连接远程服务器" class="header-anchor">#</a> SSH连接远程服务器</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>ssh 用户名@远程服务器IP
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>ssh</code>: 安全外壳协议客户端</li> <li><code>用户名@服务器IP</code>: 指定登录用户和服务器地址</li></ul> <p><strong>常用参数：</strong></p> <ul><li><code>-p 端口</code>: 指定连接端口（默认22）</li> <li><code>-i 密钥文件</code>: 指定私钥文件进行身份验证</li> <li><code>-L 本地端口:目标主机:目标端口</code>: 本地端口转发</li> <li><code>-R 远程端口:目标主机:目标端口</code>: 远程端口转发</li></ul> <p><strong>使用场景：</strong></p> <ul><li>安全连接Linux服务器</li> <li>端口转发访问内网服务</li> <li>通过跳板机连接内网服务器</li></ul> <hr> <h3 id="telnet连接远程服务器"><a href="#telnet连接远程服务器" class="header-anchor">#</a> Telnet连接远程服务器</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>telnet 远程服务器IP 端口号
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>telnet</code>: 终端仿真程序</li> <li><code>远程服务器IP</code>: 目标服务器地址</li> <li><code>端口号</code>: 目标服务端口（可选，默认23）</li></ul> <p><strong>使用场景：</strong></p> <ul><li>测试端口连通性</li> <li>连接支持Telnet的设备</li> <li>网络设备配置（如交换机、路由器）</li></ul> <hr> <h3 id="ftp连接远程服务器"><a href="#ftp连接远程服务器" class="header-anchor">#</a> FTP连接远程服务器</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>ftp 远程服务器IP
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>ftp</code>: 文件传输协议客户端</li> <li><code>远程服务器IP</code>: FTP服务器地址</li></ul> <p><strong>常用FTP命令：</strong></p> <ul><li><code>open 服务器IP</code>: 连接到FTP服务器</li> <li><code>user 用户名</code>: 输入用户名</li> <li><code>pass 密码</code>: 输入密码</li> <li><code>ls</code>: 列出远程目录内容</li> <li><code>get 文件名</code>: 下载文件</li> <li><code>put 文件名</code>: 上传文件</li> <li><code>bye</code>: 退出FTP</li></ul> <p><strong>使用场景：</strong></p> <ul><li>上传网站文件到服务器</li> <li>从服务器下载日志文件</li> <li>批量文件传输任务</li></ul> <hr> <h3 id="powershell远程连接"><a href="#powershell远程连接" class="header-anchor">#</a> PowerShell远程连接</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>powershell -Command &quot;Enter-PSSession -ComputerName 远程服务器IP -Credential 用户名&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>powershell</code>: PowerShell命令行</li> <li><code>-Command</code>: 执行指定的PowerShell命令</li> <li><code>Enter-PSSession</code>: 进入远程PowerShell会话</li> <li><code>-ComputerName</code>: 指定远程计算机</li> <li><code>-Credential</code>: 指定凭据</li></ul> <p><strong>使用场景：</strong></p> <ul><li>远程执行PowerShell脚本</li> <li>管理Windows服务器</li> <li>批量服务器配置管理</li></ul> <hr> <h3 id="winrm远程连接"><a href="#winrm远程连接" class="header-anchor">#</a> WinRM远程连接</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>winrs -r:远程服务器IP -u:用户名 -p:密码 命令
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>winrs</code>: Windows远程Shell命令</li> <li><code>-r:远程服务器IP</code>: 指定远程计算机</li> <li><code>-u:用户名</code>: 指定用户名</li> <li><code>-p:密码</code>: 指定密码</li> <li><code>命令</code>: 要在远程计算机上执行的命令</li></ul> <p><strong>使用场景：</strong></p> <ul><li>远程执行单个命令</li> <li>批量服务器管理</li> <li>自动化远程任务执行</li></ul> <hr> <h2 id="远程服务器管理"><a href="#远程服务器管理" class="header-anchor">#</a> 远程服务器管理</h2> <h3 id="批量连接远程服务器脚本示例"><a href="#批量连接远程服务器脚本示例" class="header-anchor">#</a> 批量连接远程服务器脚本示例</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
setlocal enabledelayedexpansion

echo 远程服务器连接脚本
echo ====================

:: 服务器列表
set servers[0]=192.168.1.100
set servers[1]=192.168.1.101
set servers[2]=192.168.1.102

:: 用户名和密码
set username=admin
set password=yourpassword

:: 循环连接每个服务器
for /l %%i in (0,1,2) do (
    echo 正在连接服务器: !servers[%%i]!
    winrs -r:!servers[%%i]! -u:!username! -p:!password! &quot;systeminfo | findstr /B /C:\&quot;OS Name\&quot; /C:\&quot;System Type\&quot;&quot;
    echo.
)

pause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>setlocal enabledelayedexpansion</code>: 启用延迟变量扩展</li> <li><code>set servers[0]=...</code>: 定义服务器数组</li> <li><code>for /l %%i in (0,1,2)</code>: 循环遍历服务器列表</li> <li><code>winrs</code>: 远程执行命令</li> <li><code>systeminfo | findstr</code>: 获取系统信息并过滤</li></ul> <p><strong>使用场景：</strong></p> <ul><li>批量检查多台服务器状态</li> <li>统一管理服务器集群</li> <li>自动化运维任务</li></ul> <hr> <h3 id="远程文件传输脚本"><a href="#远程文件传输脚本" class="header-anchor">#</a> 远程文件传输脚本</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
setlocal

echo 远程文件传输脚本
echo =================

set server=192.168.1.100
set username=admin
set password=yourpassword
set localFile=C:\data\report.txt
set remoteFolder=\\%server%\shared\reports

:: 创建凭据
cmdkey /add:%server% /user:%username% /pass:%password%

:: 复制文件到远程服务器
copy &quot;%localFile%&quot; &quot;%remoteFolder%&quot;

if %errorlevel% equ 0 (
    echo 文件传输成功
) else (
    echo 文件传输失败
)

:: 删除凭据
cmdkey /delete:%server%

pause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>cmdkey /add</code>: 添加凭据</li> <li><code>cmdkey /delete</code>: 删除凭据</li> <li><code>copy</code>: 复制文件</li> <li><code>%errorlevel%</code>: 检查上一条命令的执行结果</li></ul> <p><strong>使用场景：</strong></p> <ul><li>自动化备份文件到远程服务器</li> <li>批量分发文件到多台计算机</li> <li>定期同步数据</li></ul> <hr> <h2 id="实用脚本示例"><a href="#实用脚本示例" class="header-anchor">#</a> 实用脚本示例</h2> <h3 id="批量重命名文件"><a href="#批量重命名文件" class="header-anchor">#</a> 批量重命名文件</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
setlocal enabledelayedexpansion
set count=1
for %%f in (*.jpg) do (
    ren &quot;%%f&quot; &quot;图片!count!.jpg&quot;
    set /a count+=1
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>@echo off</code>: 关闭命令回显</li> <li><code>setlocal enabledelayedexpansion</code>: 启用延迟变量扩展</li> <li><code>set count=1</code>: 初始化计数器</li> <li><code>for %%f in (*.jpg)</code>: 遍历所有jpg文件</li> <li><code>ren &quot;%%f&quot; &quot;图片!count!.jpg&quot;</code>: 重命名文件</li> <li><code>set /a count+=1</code>: 计数器递增</li></ul> <p><strong>使用场景：</strong></p> <ul><li>整理照片文件</li> <li>批量重命名下载的文件</li> <li>标准化文件命名格式</li></ul> <hr> <h3 id="清理系统临时文件"><a href="#清理系统临时文件" class="header-anchor">#</a> 清理系统临时文件</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
del /q /f /s %temp%\*
del /q /f /s C:\Windows\Temp\*
echo 临时文件清理完成
pause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>del /q /f /s</code>: 安静模式强制删除所有子目录中的文件</li> <li><code>%temp%</code>: 系统临时文件夹环境变量</li> <li><code>echo</code>: 显示消息</li> <li><code>pause</code>: 暂停执行，等待用户按键</li></ul> <p><strong>使用场景：</strong></p> <ul><li>释放磁盘空间</li> <li>提高系统性能</li> <li>定期系统维护</li></ul> <hr> <h3 id="自动设置ip地址"><a href="#自动设置ip地址" class="header-anchor">#</a> 自动设置IP地址</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
netsh interface ip set address &quot;本地连接&quot; static 192.168.1.100 255.255.255.0 192.168.1.1
netsh interface ip set dns &quot;本地连接&quot; static 8.8.8.8
echo IP地址设置完成
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>netsh</code>: 网络外壳命令</li> <li><code>interface ip set address</code>: 设置IP地址</li> <li><code>&quot;本地连接&quot;</code>: 网络连接名称</li> <li><code>static</code>: 静态IP地址</li> <li><code>192.168.1.100</code>: IP地址</li> <li><code>255.255.255.0</code>: 子网掩码</li> <li><code>192.168.1.1</code>: 默认网关</li> <li><code>8.8.8.8</code>: DNS服务器</li></ul> <p><strong>使用场景：</strong></p> <ul><li>快速切换网络环境</li> <li>服务器网络配置</li> <li>网络故障恢复</li></ul> <hr> <h3 id="自动获取ip地址"><a href="#自动获取ip地址" class="header-anchor">#</a> 自动获取IP地址</h3> <div class="language-bat line-numbers-mode"><pre class="language-text"><code>@echo off
netsh interface ip set address &quot;本地连接&quot; dhcp
netsh interface ip set dns &quot;本地连接&quot; dhcp
echo IP地址设置为自动获取
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>参数解析：</strong></p> <ul><li><code>dhcp</code>: 动态主机配置协议（自动获取IP）</li></ul> <p><strong>使用场景：</strong></p> <ul><li>从静态IP切换回动态IP</li> <li>在不同网络环境间切换</li> <li>网络故障排查时重置网络配置</li></ul></div> <footer class="page-edit" style="margin:0;"><!----> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">11/17/2025, 10:23:58 AM</span></div></footer> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">常用的bat命令</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#windows命令兼容性说明" class="toc-sidebar-link">Windows命令兼容性说明</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#完全兼容的windows版本" class="toc-sidebar-link">完全兼容的Windows版本</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#需要注意的命令" class="toc-sidebar-link">需要注意的命令</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#权限要求" class="toc-sidebar-link">权限要求</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#使用建议" class="toc-sidebar-link">使用建议</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#如何创建bat文件" class="toc-sidebar-link">如何创建bat文件</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#方法一-使用记事本创建" class="toc-sidebar-link">方法一：使用记事本创建</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#方法二-使用文本编辑器创建" class="toc-sidebar-link">方法二：使用文本编辑器创建</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#方法三-直接在文件夹中创建" class="toc-sidebar-link">方法三：直接在文件夹中创建</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#bat文件基本语法" class="toc-sidebar-link">bat文件基本语法</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#简单示例" class="toc-sidebar-link">简单示例</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#运行bat文件" class="toc-sidebar-link">运行bat文件</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#系统管理" class="toc-sidebar-link">系统管理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#重启资源管理器" class="toc-sidebar-link">重启资源管理器</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#关闭计算机" class="toc-sidebar-link">关闭计算机</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#重启计算机" class="toc-sidebar-link">重启计算机</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#注销当前用户" class="toc-sidebar-link">注销当前用户</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#锁定计算机" class="toc-sidebar-link">锁定计算机</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#查看系统信息" class="toc-sidebar-link">查看系统信息</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#查看ip配置" class="toc-sidebar-link">查看IP配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#刷新dns缓存" class="toc-sidebar-link">刷新DNS缓存</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#ping测试网络连接" class="toc-sidebar-link">ping测试网络连接</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#文件和文件夹操作" class="toc-sidebar-link">文件和文件夹操作</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#创建文件夹" class="toc-sidebar-link">创建文件夹</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#删除文件夹" class="toc-sidebar-link">删除文件夹</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#复制文件" class="toc-sidebar-link">复制文件</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#复制文件夹及其内容" class="toc-sidebar-link">复制文件夹及其内容</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#删除文件" class="toc-sidebar-link">删除文件</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#进程管理" class="toc-sidebar-link">进程管理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#查看运行中的进程" class="toc-sidebar-link">查看运行中的进程</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#结束指定进程" class="toc-sidebar-link">结束指定进程</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#环境变量" class="toc-sidebar-link">环境变量</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#查看所有环境变量" class="toc-sidebar-link">查看所有环境变量</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#设置临时环境变量" class="toc-sidebar-link">设置临时环境变量</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#磁盘管理" class="toc-sidebar-link">磁盘管理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#查看磁盘使用情况" class="toc-sidebar-link">查看磁盘使用情况</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#磁盘检查" class="toc-sidebar-link">磁盘检查</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#网络管理" class="toc-sidebar-link">网络管理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#查看网络连接" class="toc-sidebar-link">查看网络连接</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#映射网络驱动器" class="toc-sidebar-link">映射网络驱动器</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#远程桌面连接" class="toc-sidebar-link">远程桌面连接</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#使用凭据连接远程服务器" class="toc-sidebar-link">使用凭据连接远程服务器</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#ssh连接远程服务器" class="toc-sidebar-link">SSH连接远程服务器</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#telnet连接远程服务器" class="toc-sidebar-link">Telnet连接远程服务器</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#ftp连接远程服务器" class="toc-sidebar-link">FTP连接远程服务器</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#powershell远程连接" class="toc-sidebar-link">PowerShell远程连接</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#winrm远程连接" class="toc-sidebar-link">WinRM远程连接</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#远程服务器管理" class="toc-sidebar-link">远程服务器管理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#批量连接远程服务器脚本示例" class="toc-sidebar-link">批量连接远程服务器脚本示例</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#远程文件传输脚本" class="toc-sidebar-link">远程文件传输脚本</a></li></ul></li><li><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#实用脚本示例" class="toc-sidebar-link">实用脚本示例</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#批量重命名文件" class="toc-sidebar-link">批量重命名文件</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#清理系统临时文件" class="toc-sidebar-link">清理系统临时文件</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#自动设置ip地址" class="toc-sidebar-link">自动设置IP地址</a></li><li class="toc-sidebar-sub-header"><a href="/%E5%B8%B8%E7%94%A8%E7%9A%84bat%E5%91%BD%E4%BB%A4/#自动获取ip地址" class="toc-sidebar-link">自动获取IP地址</a></li></ul></li></ul></div></div></div></div></div>  <main class="footer"></main></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a3927c81.js" defer></script><script src="/assets/js/2.774f00ec.js" defer></script><script src="/assets/js/95.de2f22d5.js" defer></script>
  </body>
</html>
